<!DOCTYPE html>
<html lang="Zh-Hans">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>我的画板</title>
    <link rel="stylesheet" href="./css/style.css" type="text/css">
    <script src="//at.alicdn.com/t/font_1003331_sgukirayhn.js" type="text/javascript"></script>
</head>
<body>
    <canvas id="canvas" width="1000px" height="1000px"></canvas>
    <div id="actions" class="actions" >
            <svg id="pen" class="icon active" aria-hidden="true">
                <use xlink:href="#icon-pen"></use>
            </svg>
            <svg id="eraser" class="icon" aria-hidden="true">
                <use xlink:href="#icon-ico-erasertool-May"></use>
            </svg>
            <svg id="clear" class="icon" aria-hidden="true">
                    <use xlink:href="#icon-shanchu"></use>
                </svg>
    </div>
    <div class="colors">
        <ol>
            <li id="black" class="black active"></li>
            <li id="red" class="red"></li>
            <li id="blue" class="blue"></li>
            <li id="grey" class="grey"></li>
            <li id="yellow" class="yellow"></li>
            <li id="orange" class="orange"></li>
            <li id="green" class="green"></li>
        </ol>
    </div>
    <div class="sizes">
        <ol class="clearfix">
            <li id="thin" class="thin"></li>
            <li id="thick" class="thick"></li>
        </ol>
    </div>
    <script type="text/javascript">
        var canvas = document.getElementById('canvas');
		setCanvasSize()
		
		function setCanvasSize(){
			var pageWidth = document.documentElement.clientWidth
			var pageHeight = document.documentElement.clientHeight
			
			canvas.width = pageWidth
			canvas.height = pageHeight
		}
		window.onresize = function(){
			setCanvasSize()
		}
		
		
		/*context.fillStyle = 'green';//填充矩形颜色
		context.fillRect(10, 10, 100, 100);//填充矩形
		
		context.strokeStyle = 'red';//绘制矩形颜色（指描边）
		context.strokeRect(10, 10, 100, 100);//绘制矩形
		
		context.clearRect(30,30,20,20);//清除（擦掉）矩形，橡皮擦
		
		
		//绘制三角形
		context.beginPath();
		context.moveTo(600,600);
		context.lineTo(900,600);
		context.lineTo(900,1000);
		context.fill();
		
		//绘制圆形
		context.beginPath();
		context.arc(300,300,50,0,Math.PI*2);
		context.stroke();
		context.fill();
		
		//绘制线
		context.beginPath()
		context.moveTo(0,0)//起点
		context.lineWidth = 10
		context.lineTo(600,0)//终点
		context.stroke()
		context.closePath()*/
		
		/****/
        var context = canvas.getContext('2d');//2d是二次元的意思
        
		var using = false
        var lastPoint = {'x':undefined, 'y':undefined}
        var lineWidth = 2
        
        //特性检测
        if(document.body.ontouchstart !== undefined){
            //触屏设备
            //监听触摸手机屏幕事件
            canvas.ontouchstart = function(aaa){
                //console.log('开始触摸我了')
                var x = aaa.touches[0].clientX
                var y = aaa.touches[0].clientY
                if(eraserEnabled){
                    using = true
                    context.clearRect(x-5,y-5,10,10)
                }else{
                    using = true
                    lastPoint = {'x':x, 'y':y}
                    /*drawCircle(x,y,1)*/
                }
            }

            canvas.ontouchmove = function(aaa){
                //console.log('边触摸边移动')
                var x = aaa.touches[0].clientX
                var y = aaa.touches[0].clientY
                if(eraserEnabled){
                    if(using){
                        context.clearRect(x-5,y-5,10,10)
                    }				
                }else{
                    if(using){
                
                    var newPoint = {'x':x, 'y':y}
                    /*drawCircle(x,y,1)*/
                    drawLine(lastPoint.x,lastPoint.y,newPoint.x,newPoint.y)
                    lastPoint = newPoint
                    }else{
                
                    }
                }
            }

            canvas.ontouchend = function(aaa){
                //console.log('触摸结束')
                using = false
            }
        }else{
            //非触屏设备（电脑设备）
            //监听鼠标按下
            canvas.onmousedown = function(aaa){
                var x = aaa.clientX
                var y = aaa.clientY
                if(eraserEnabled){
                    using = true
                    context.clearRect(x-5,y-5,10,10)
                }else{
                    using = true
                    lastPoint = {'x':x, 'y':y}
                    /*drawCircle(x,y,1)*/
                }
                
            }
            //监听鼠标移动
            canvas.onmousemove = function(aaa){
                var x = aaa.clientX
                var y = aaa.clientY
                if(eraserEnabled){
                    if(using){
                        context.clearRect(x-5,y-5,10,10)
                    }				
                }else{
                    if(using){
                
                    var newPoint = {'x':x, 'y':y}
                    /*drawCircle(x,y,1)*/
                    drawLine(lastPoint.x,lastPoint.y,newPoint.x,newPoint.y)
                    lastPoint = newPoint
                    }else{
                
                    }
                }
            }
            //监听鼠标松开
            canvas.onmouseup = function(aaa){
                using = false
            }
        }		
        
		
		function drawCircle(x,y,radius){
			context.beginPath()
			context.arc(x,y,radius,0,Math.PI*2)
			context.fill()
		}
		
		function drawLine(x1,y1,x2,y2){
			context.beginPath()
			context.moveTo(x1,y1)//起点
			context.lineWidth = lineWidth
			context.lineTo(x2,y2)//终点
			context.stroke()
			context.closePath()
		}
		
		//监听点击画笔还是橡皮擦？
		var eraserEnabled = false
		  eraser.onclick = function() {
		  eraserEnabled =true
          eraser.classList.add ('active')
          pen.classList.remove('active')
		
		}
		  pen.onclick = function(){
		  eraserEnabled = false
          pen.classList.add('active')
          eraser.classList.remove('active')
        }
        
        //监听点击哪个颜色画笔就是哪个颜色
        black.onclick = function(){
            context.fillStyle = 'black'
            context.strokeStyle = 'black'
            black.classList.add('active')
            red.classList.remove('active')
            green.classList.remove('active')
            grey.classList.remove('active')
            blue.classList.remove('active')
            yellow.classList.remove('active')
            orange.classList.remove('active')
        }
        red.onclick = function(){
            context.fillStyle = 'red'
            context.strokeStyle = 'red'
            red.classList.add('active')
            green.classList.remove('active')
            black.classList.remove('active')
            grey.classList.remove('active')
            blue.classList.remove('active')
            yellow.classList.remove('active')
            orange.classList.remove('active')
        }
        blue.onclick = function(){
            context.fillStyle = 'blue'
            context.strokeStyle = 'blue'
            blue.classList.add('active')
            red.classList.remove('active')
            green.classList.remove('active')
            black.classList.remove('active')
            grey.classList.remove('active')
            yellow.classList.remove('active')
            orange.classList.remove('active')
        }
        grey.onclick = function(){
            context.fillStyle = 'grey'
            context.strokeStyle = 'grey'
            grey.classList.add('active')
            red.classList.remove('active')
            green.classList.remove('active')
            black.classList.remove('active')
            blue.classList.remove('active')
            yellow.classList.remove('active')
            orange.classList.remove('active')
        }
        
        yellow.onclick = function(){
            context.fillStyle = 'yellow'
            context.strokeStyle = 'yellow'
            yellow.classList.add('active')
            red.classList.remove('active')
            green.classList.remove('active')
            black.classList.remove('active')
            grey.classList.remove('active')
            blue.classList.remove('active')
            orange.classList.remove('active')
        }
        orange.onclick = function(){
            context.fillStyle = 'orange'
            context.strokeStyle = 'orange'
            orange.classList.add('active')
            red.classList.remove('active')
            green.classList.remove('active')
            black.classList.remove('active')
            grey.classList.remove('active')
            blue.classList.remove('active')
            yellow.classList.remove('active')
        }
        green.onclick = function(){
            context.fillStyle = 'green'
            context.strokeStyle = 'green'
            green.classList.add('active')
            red.classList.remove('active')
            black.classList.remove('active')
            grey.classList.remove('active')
            blue.classList.remove('active')
            yellow.classList.remove('active')
            orange.classList.remove('active')
        }
        //监听线的粗细
        thin.onclick = function(){
            lineWidth = 2
        }
        thick.onclick = function(){
            lineWidth = 5
        }
        //清楚内容
        clear.onclick = function(){
            context.clearRect(0, 0, canvas.width, canvas.height)
        }
        
        
        

    </script>
</body>
</html>